<!DOCTYPE HTML>
<html lang="utf-8">
<head>
	<meta charset="UTF-8">
	<title></title>
	<link href="/ligerStatic/lib/ligerUI/skins/Aqua/css/ligerui-all.css" rel="stylesheet" type="text/css"> 
    <link href="/ligerStatic/lib/ligerUI/skins/Gray/css/all.css" rel="stylesheet" type="text/css"> 
	<link href="/ligerStatic/css/style-item.css" rel="stylesheet" media="all" />
    <script src="/ligerStatic/lib/jquery/jquery-1.5.2.min.js" type="text/javascript"></script>
    <script src="/ligerStatic/lib/ligerUI/js/ligerui.min.js" type="text/javascript"></script> 
    <script src="/ligerStatic/lib/ligerUI/js/plugins/ligerForm.js" type="text/javascript"></script>
    <script src="/ligerStatic/lib/ligerUI/js/plugins/ligerDateEditor.js" type="text/javascript"></script>
    <script src="/ligerStatic/lib/ligerUI/js/plugins/ligerComboBox.js" type="text/javascript"></script>
    <script src="/ligerStatic/lib/ligerUI/js/plugins/ligerCheckBox.js" type="text/javascript"></script>
	<script src="/ligerStatic/lib/ligerUI/js/plugins/ligerGrid.js" type="text/javascript"></script>
    <script src="/ligerStatic/lib/ligerUI/js/plugins/ligerButton.js" type="text/javascript"></script>
    <script src="/ligerStatic/lib/ligerUI/js/plugins/ligerDialog.js" type="text/javascript"></script>
    <script src="/ligerStatic/lib/ligerUI/js/plugins/ligerRadio.js" type="text/javascript"></script>
    <script src="/ligerStatic/lib/ligerUI/js/plugins/ligerSpinner.js" type="text/javascript"></script>
    <script src="/ligerStatic/lib/ligerUI/js/plugins/ligerTextBox.js" type="text/javascript"></script> 
    <script src="/ligerStatic/lib/ligerUI/js/plugins/ligerTip.js" type="text/javascript"></script>
    <script src="/ligerStatic/lib/jquery-validation/jquery.validate.min.js" type="text/javascript"></script> 
    <script src="/ligerStatic/lib/jquery-validation/jquery.metadata.js" type="text/javascript"></script>
    <script src="/ligerStatic/lib/jquery-validation/messages_cn.js" type="text/javascript"></script>
	
	<script type="text/javascript">
		//t通过栏目名查出栏目ID
		var grid;
		var menu;
		var coId;
		var mcoName='领导致词';
		 $(function() {
             $.ajax({
                 url: "/admin/cols",
                 type: 'get',
                 dataType: "json",
                 success: function (result) {
                     coId = 0;
                     var cols = result.extend.cols;
                     $.each(cols, function (index, col) {

                         if (col.coName==mcoName) {
                             coId = col.coId;
                         }
                     });
                     if (coId !== 0) {
                         //通过栏目id查询文章
                         init(coId);
                     } else {
                         alert("不存在此栏目");
                     }
                 }

             });


             $("#btnAdd").click(function () {
                 var tabId = "addArtTab";
                 parent.f_addTab(tabId, "起草文章", "/admin/kindEditor?coId=" + coId);
             });
             $("#btnRefresh").click(function () {
                 grid.loadData();
             });
             $("#btnDel").click(function () {
                 var rows = grid.getSelectedRows();
                 if (rows === null || rows.length === 0) {
                     alert("您没有选择数据");
                 } else {
                     var ids = '';
                     $.each(rows, function (index, row) {
                         var id = row.id;
                         alert("id=" + id);
                         ids = ids + id + "-";
                     });
                     ids = ids.substring(0, ids.length - 1);

                     //提示确认
                     alert(ids);
                     //批量删除
                     $.ajax({
                         url: "/admin/art/" + ids,
                         type: "delete",
                         dataType: "json",
                         success: function (result) {
                             alert(result.msg);
                             //刷新列表
                             grid.loadData();
                         },
                         error: function (code, result) {
                             alert(code + result.msg);
                         }
                     });

                 }
             });


			var s = decodeURIComponent(getPar("coName"));
			s=s.substring(1,s.length-1);
             alert('coName=' +s);
             var coName = s;
             if (coName !== null || coName !== "") {
                 //获取文章ID的详细
                 mcoName = coName;

             }
//			var griddata = [
//			{ ArtTitle: '1', ArtSubTitle: '1',Publictime:'1',From:'1',Status:'1', ClickCount:"1"},
//                { ArtTitle: '3', ArtSubTitle: '3',Publictime:'3',From:'3',Status:'3', ClickCount:"3"},
//                { ArtTitle: '5', ArtSubTitle: '5',Publictime:'5',From:'5',Status:'5', ClickCount:"6"},
//                { ArtTitle: '7', ArtSubTitle: '7',Publictime:'7',From:'7',Status:'7', ClickCount:"7"}
//			];


             function itemclick(rowdata) {
                 alert("右键点击" + typeof (rowdata));
             }

             function init(coId) {
                 $("form-info").ligerForm();
                 menu = $.ligerMenu({
                     width: 120, items:
                         [{text: '查看', click: itemclick}]
                 });
                 grid = $("#articleList").ligerGrid({
                     width: '100%',
                     height: '100%',
                     rowHeight: 30,
                     headerRowHeight: 30,
                     checkbox: true,
                     columns: [
                         {name: 'id', display: '文章ID', hide: true},
                         {name: 'coId', display: '栏目ID', hide: true},
                         {name: 'title', display: '文章标题'},
                         {name: 'subTitle', display: '副标题'},
                         {name: 'publicTime', display: '发布时间'},
                         {name: 'from', display: '来源'},
                         {name: 'status', display: '审核状态'},
                         {name: 'clickCount', display: '点击数'}

                     ],
                     url: '/admin/arts/' + coId,
                     method: 'get',
                     usePager: true,
                     pageSize: 10,//分页页面大小
                     pageSizeOptions: [10, 20, 30],//可指定每页页面大小
                     onDblClickRow: function (rowdata, rowindex) {
                         alert("你选择了" + rowindex + "行" + "文章ID为" + rowdata.id);
                         //跳转到content页面
                         window.open("/content.html?id=" + rowdata.id);
                     },
                     onContextmenu: function (parm, e) {
                         actionCustomerID = parm.data.CustomerID;
                         menu.show({top: e.pageY, left: e.pageX});
                         return false;
                     }


                 });

             }

             function getPar(par) {
                 var localUrl = document.location.href;
                 var get = localUrl.indexOf(par + "=");
                 if (get === -1) {
                     return false;
                 }

                 var get_par = localUrl.slice(par.length + get + 1);
                 return get_par;
             }

         });




</script> 

</head>
<body>
	<style type="text/css">
		
		#Mail{
			margin:0 auto;
		}
		.block{
			height:20px;
		}
		.line{
			height:40px;
		}
		.btn{
			background:	#FF3030;
			line-height:20px;
			width:50px;
			border-radius:50px;
			border:1px solid;
			color:#fff;
			font-size:8px;
		}
		.back{
			background:#fff;
			line-height:30px;
			width:50px;
			border-radius:50px;
			border:1px solid;
			color:#999;
			font-size:8px;
		}
		#refresh{
			background:	#71C671;
			line-height:20px;
			width:50px;
			border-radius:50px;
			border:1px solid;
			color:#fff;
			font-size:8px;
		}
		#delete{
			background:	#778899;
			line-height:20px;
			width:50px;
			border-radius:50px;
			border:1px solid;
			color:#fff;
			font-size:8px;
		}
		#unread{
			background:	#FFA54F;
			line-height:20px;
			width:70px;
			border-radius:50px;
			border:1px solid;
			color:#fff;
			font-size:8px;
		}
		.labels{
			width:50px;
			display: inline-block;
		}
		.operate{
			margin:0 auto;
		}
		.select{
			position:absolute;
			left:55px;
		}
	</style>
	
	<div class="item-main">
		<table>
			<tr>
				<td style="width:5px"></td>
				<td><input id="btnAdd" type="button" value="新增" class="l-button" style="width:50px;color:#57b255;"></input></td>
				<td style="width:5px"></td>
				<td><input id="btnRefresh"type="button" value="刷新" class="l-button" style="width:50px;color:#57b255;"></input></td>
				<td style="width:5px"></td>
				<td><input id="btnDel"type="button" value="删除" class="l-button" style="width:50px;color:#778899;"></input></td>
				<td><span>双击或右键选择查看</span></td>
			</tr>
		</table>
		<div class="container" align="center" style="width: 100%">
			<div id="articleList" style="width: 100%"></div>
		</div>
	</div>
	
</body>
</html>